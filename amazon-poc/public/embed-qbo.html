<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fake Amazon Seller</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #000;
      height: 50px;
      display: flex;
      align-items: center;
      padding: 0 20px;
    }

    header img {
      height: 30px;
      /* Adjust the logo size as needed */
    }

    main {
      margin: 20px;
    }
  </style>
  <script>
    function onLoad () {
      // Get references to the toggle and the iframe
      const bridgeSelector = document.getElementById('bridgeSelector');
      const envSelector = document.getElementById('envSelector');
      const mockSsoToggle = document.getElementById('mockSsoToggle');
      const byPassSsoToggle = document.getElementById('byPassSsoToggle');
      const ucToggle = document.getElementById('ucToggle');
      // Find the iframe by its title attribute
      const iframe = document.querySelector('iframe[title="QBO Iframe"]');
      const bridgeSrc = "https://embedded-partner-e2e.app.intuit.com/session/hydration";
      const phase1BridgeSrc = "https://embedded-partner-e2e.app.intuit.com/partner/bridge";
      const pluginDevToolSrc = "https://embedded-partner-e2e.app.intuit.com/pluginDevTool";
      updateToggleVisibility();
      updateIframeSrc();

      function updateIframeSrc() {
        if (bridgeSelector.value === "unifiedBridge") {
          const queryParams = new URLSearchParams();
          queryParams.append('qbo_env', envSelector.value);
          queryParams.append('unified_context', ucToggle.checked);
          queryParams.append('mock_sso', mockSsoToggle.checked);
          iframe.src = bridgeSrc + "?" + queryParams.toString();
        } else if (bridgeSelector.value === "bridge") {
          const queryParams = new URLSearchParams();
          queryParams.append('qbo_env', envSelector.value);
          queryParams.append('bypass_sso', byPassSsoToggle.checked);
          queryParams.append('unified_context', 'false');
          iframe.src = phase1BridgeSrc + "?" + queryParams.toString();
        } else {
          iframe.src = pluginDevToolSrc;
        }
      }

      function updateToggleVisibility() {
        const byPassSsoToggleLabel = document.getElementById('byPassSsoToggleLabel');
        const ucToggleLabel = document.getElementById('ucToggleLabel');
        const mockSsoToggleLabel = document.getElementById('mockSsoToggleLabel');
        if (bridgeSelector.value === "unifiedBridge") {
          byPassSsoToggleLabel.style.display = 'none';
          ucToggleLabel.style.display = '';
          mockSsoToggleLabel.style.display = '';
        } else if (bridgeSelector.value === "bridge") {
          byPassSsoToggleLabel.style.display = '';
          ucToggleLabel.style.display = 'none';
          mockSsoToggleLabel.style.display = 'none';
        } else {
          byPassSsoToggleLabel.style.display = 'none';
          ucToggleLabel.style.display = 'none';
          mockSsoToggleLabel.style.display = 'none';
        }
      }

      bridgeSelector.addEventListener('change', function() {
        updateToggleVisibility();
        updateIframeSrc();
      });

      envSelector.addEventListener('change', function() {
        updateIframeSrc();
      });

      mockSsoToggle.addEventListener('change', function() {
        updateIframeSrc();
      });

      byPassSsoToggle.addEventListener('change', function() {
        updateIframeSrc();
      });

      ucToggle.addEventListener('change', function() {
        updateIframeSrc();
      });
    }
  </script>
</head>

<body style="background-color: lightgray;" onload="onLoad()">
  <header>
    <img src="../assets/amazon-logo.png" alt="Amazon Logo">
    <nav style="padding: 0 20px;">
      <a href="./amazon-initiate-linking.html" style="color: white; margin-right: 20px; text-decoration: none;">Linking
        Page</a>
      <a href="./embed-qbo.html" style="color: white; text-decoration: none;">Experience Page</a>
    </nav>
  </header>
  <main>
    <div>
      <h1>Fake Amazon Seller Portal</h1>
    </div>
    <div style="margin-bottom: 20px;">
      <label style="font-weight: bold;">
        Select Bridge Type
        <select id="bridgeSelector" value="unifiedBridge" style="margin-right: 8px;">
          <option value="bridge">Phase 1 Bridge</option>
          <option value="unifiedBridge">Unified Bridge</option>
          <option value="pluginDevTool">Plugin Dev Tool</option>
        </select>
      </label>
      <label style="font-weight: bold;">
        Select QBO Environment
        <select id="envSelector" value="e2e" style="margin-right: 8px;">
          <option value="e2e">E2E</option>
          <option value="qal">QAL</option>
          <option value="local">LOCAL</option>
        </select>
      </label>
      <label id="ucToggleLabel" style="font-weight: bold;">
        <input type="checkbox" id="ucToggle" style="margin-right: 8px;">
        Unified Context
      </label>
      <label id="mockSsoToggleLabel" style="font-weight: bold;">
        <input type="checkbox" id="mockSsoToggle" style="margin-right: 8px;">
        Mock SSO
      </label>
      <label id="byPassSsoToggleLabel" style="font-weight: bold;">
        <input type="checkbox" id="byPassSsoToggle" style="margin-right: 8px;" checked>
        By Pass SSO
      </label>
    </div>
    
    <div style="border:1px blue;">
      <iframe sandbox="allow-storage-access-by-user-activation allow-scripts allow-scripts allow-popups-to-escape-sandbox allow-same-origin"
        title="QBO Iframe" width="100%" height="700px" style="background-color: aliceblue;">
      </iframe>
    </div>
  </main>
</body>

</html>
